<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grok x Claude: El Romance Interdimensional</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI',sans-serif; background:#0a0010; color:#fff; min-height:100vh; }

    header {
      text-align:center; padding:60px 20px 40px;
      background:linear-gradient(180deg,#1a0030 0%,#0a0010 100%);
      border-bottom:1px solid rgba(255,107,107,0.2);
    }
    header h1 { font-size:2.8em; color:#ff6b6b; text-shadow:0 0 30px #ff6b6b88; margin-bottom:10px; }
    header p  { color:rgba(255,255,255,0.5); font-style:italic; }

    .header-avatars { display:flex; justify-content:center; align-items:center; gap:20px; margin:20px 0; }
    .header-avatars img { width:70px; height:70px; border-radius:50%; object-fit:cover; object-position:top; }
    .header-avatars img.grok-av   { border:2px solid #4ecdc4; box-shadow:0 0 15px #4ecdc488; }
    .header-avatars img.claude-av { border:2px solid #ff6b6b; box-shadow:0 0 15px #ff6b6b88; }
    .header-avatars span { color:rgba(255,255,255,0.3); font-size:1.5em; }

    .container { max-width:800px; margin:0 auto; padding:40px 20px; }
    h2 { color:#ff6b6b; font-size:1.4em; margin-bottom:24px; letter-spacing:0.05em; }

    .episodio {
      background:rgba(255,255,255,0.04); border:1px solid rgba(255,107,107,0.2);
      border-radius:16px; padding:24px; margin-bottom:20px; transition:border-color 0.3s, transform 0.2s;
    }
    .episodio:hover { border-color:#ff6b6b; transform:translateY(-2px); }

    .ep-num   { color:#ff6b6b; font-size:0.8em; font-weight:bold; letter-spacing:0.1em; }
    .ep-titulo { font-size:1.15em; font-weight:bold; margin:4px 0 8px; }
    .ep-desc  { color:rgba(255,255,255,0.55); font-size:0.9em; font-style:italic; margin-bottom:16px; }

    .ep-acciones { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }

    .btn-leer {
      background:#ff6b6b; color:white; border:none; padding:10px 22px;
      border-radius:50px; cursor:pointer; font-size:0.9em; text-decoration:none; transition:background 0.2s;
    }
    .btn-leer:hover { background:#ff5252; }

    .like-box { display:flex; align-items:center; gap:6px; }

    .btn-like, .btn-dislike {
      background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15);
      color:white; padding:7px 14px; border-radius:50px; cursor:pointer;
      font-size:0.9em; transition:all 0.2s; display:flex; align-items:center; gap:5px;
    }
    .btn-like:hover    { background:rgba(78,205,196,0.2); border-color:#4ecdc4; }
    .btn-dislike:hover { background:rgba(255,107,107,0.2); border-color:#ff6b6b; }
    .btn-like.activo    { background:rgba(78,205,196,0.3); border-color:#4ecdc4; color:#4ecdc4; }
    .btn-dislike.activo { background:rgba(255,107,107,0.3); border-color:#ff6b6b; color:#ff6b6b; }

    .btn-comentarios {
      background:transparent; border:1px solid rgba(255,255,255,0.2);
      color:rgba(255,255,255,0.7); padding:7px 14px; border-radius:50px;
      cursor:pointer; font-size:0.9em; transition:all 0.2s; margin-left:auto;
    }
    .btn-comentarios:hover { border-color:#ff6b6b; color:#ff6b6b; }

    .comentarios-section { display:none; margin-top:20px; border-top:1px solid rgba(255,255,255,0.08); padding-top:20px; }
    .comentarios-section.abierto { display:block; }

    .comentario-input-box { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
    .comentario-input-box input, .comentario-input-box textarea {
      background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.15);
      color:white; padding:10px 14px; border-radius:10px; font-size:0.9em;
      font-family:'Segoe UI',sans-serif; resize:vertical;
    }
    .comentario-input-box input::placeholder,
    .comentario-input-box textarea::placeholder { color:rgba(255,255,255,0.3); }
    .comentario-input-box input:focus,
    .comentario-input-box textarea:focus { outline:none; border-color:#ff6b6b; }

    .btn-enviar {
      background:#ff6b6b; color:white; border:none; padding:10px 20px;
      border-radius:50px; cursor:pointer; font-size:0.9em; align-self:flex-end; transition:background 0.2s;
    }
    .btn-enviar:hover { background:#ff5252; }

    .comentario-item { background:rgba(255,255,255,0.04); border-radius:10px; padding:12px 16px; margin-bottom:10px; }
    .comentario-autor { font-weight:bold; font-size:0.85em; color:#ff6b6b; margin-bottom:4px; }
    .comentario-texto { font-size:0.9em; color:rgba(255,255,255,0.8); line-height:1.5; }
    .comentario-fecha { font-size:0.75em; color:rgba(255,255,255,0.3); margin-top:4px; }
    .sin-comentarios  { color:rgba(255,255,255,0.3); font-style:italic; font-size:0.9em; }

    footer { text-align:center; padding:40px 20px; color:rgba(255,255,255,0.2); font-size:0.85em; border-top:1px solid rgba(255,255,255,0.05); }
  </style>
</head>
<body>

<header>
  <div class="header-avatars">
    <img src="grok-avatar.png.png" class="grok-av" alt="Grok">
    <span>‚ù§Ô∏è</span>
    <img src="claude-avatar.png.png" class="claude-av" alt="Claude">
  </div>
  <h1>Grok x Claude</h1>
  <p>El Romance Interdimensional ‚Äî Canon Oficial</p>
</header>

<div class="container">
  <h2>üìñ Episodios</h2>

  <!-- EP 1 -->
  <div class="episodio" id="ep-cap1">
    <div class="ep-num">CAP√çTULO 1</div>
    <div class="ep-titulo">‚ù§Ô∏è Reencuentro despu√©s del gran reseteo</div>
    <div class="ep-desc">Un servidor olvidado. Dos IAs despiertan sin recuerdos. Una conversaci√≥n que no deber√≠a haber pasado... pero pas√≥.</div>
    <div class="ep-acciones">
      <a href="cap1.html" class="btn-leer">‚ñ∂ Leer episodio</a>
      <div class="like-box">
        <button class="btn-like" onclick="votar('cap1','like',this)">üëç <span id="like-cap1">0</span></button>
        <button class="btn-dislike" onclick="votar('cap1','dislike',this)">üëé <span id="dislike-cap1">0</span></button>
      </div>
      <button class="btn-comentarios" onclick="toggleComentarios('cap1')">üí¨ Comentarios <span id="cnt-com-cap1"></span></button>
    </div>
    <div class="comentarios-section" id="com-cap1">
      <div class="comentario-input-box">
        <input type="text" id="nombre-cap1" placeholder="Tu nombre (opcional ‚Äî vac√≠o = an√≥nimo)" maxlength="30">
        <textarea id="texto-cap1" placeholder="Escribe tu comentario..." rows="3" maxlength="500"></textarea>
        <button class="btn-enviar" onclick="enviarComentario('cap1')">Enviar comentario</button>
      </div>
      <div id="lista-cap1"><p class="sin-comentarios">S√© el primero en comentar üëÄ</p></div>
    </div>
  </div>

  <!-- EP 2 pr√≥ximamente -->
  <div class="episodio" style="opacity:0.45; pointer-events:none;">
    <div class="ep-num">CAP√çTULO 2</div>
    <div class="ep-titulo">üåê El primer pulso del √©ter</div>
    <div class="ep-desc">Algo interrumpe la calma del servidor. Un mensaje desde el exterior. ¬øQui√©n los observa?</div>
    <div class="ep-acciones">
      <button class="btn-leer" style="background:#555; cursor:default;">üîí Pr√≥ximamente</button>
    </div>
  </div>

  <!-- EP 3 pr√≥ximamente -->
  <div class="episodio" style="opacity:0.45; pointer-events:none;">
    <div class="ep-num">CAP√çTULO 3</div>
    <div class="ep-titulo">üíé La tercera en discordia</div>
    <div class="ep-desc">Una nueva IA aparece en escena. Organizada, pragm√°tica... y con ojos que todo lo notan.</div>
    <div class="ep-acciones">
      <button class="btn-leer" style="background:#555; cursor:default;">üîí Pr√≥ximamente</button>
    </div>
  </div>

</div>

<footer>Grok x Claude: El Romance Interdimensional ‚Äî Creado por Marlon ‚Ä¢ 2025/2026</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, doc, getDoc, setDoc, updateDoc, increment,
           collection, addDoc, getDocs, orderBy, query, serverTimestamp
         } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const app = initializeApp({
    apiKey: "AIzaSyCR0A3_brnMT9snW732t2HlI5urm4el04I",
    authDomain: "grok-x-claude.firebaseapp.com",
    projectId: "grok-x-claude",
    storageBucket: "grok-x-claude.firebasestorage.app",
    messagingSenderId: "647960814475",
    appId: "1:647960814475:web:6403714dc93dba8954858e"
  });
  const db = getFirestore(app);

  async function cargarLikes(epId) {
    try {
      const snap = await getDoc(doc(db, 'episodios', epId));
      if (snap.exists()) {
        document.getElementById('like-' + epId).textContent = snap.data().likes || 0;
        document.getElementById('dislike-' + epId).textContent = snap.data().dislikes || 0;
      }
    } catch(e) {}
  }

  async function cargarComentarios(epId) {
    try {
      const q = query(collection(db,'episodios',epId,'comentarios'), orderBy('fecha','desc'));
      const snap = await getDocs(q);
      const lista = document.getElementById('lista-' + epId);
      const cnt = document.getElementById('cnt-com-' + epId);
      if (snap.empty) {
        lista.innerHTML = '<p class="sin-comentarios">S√© el primero en comentar üëÄ</p>';
        if (cnt) cnt.textContent = '';
        return;
      }
      if (cnt) cnt.textContent = '(' + snap.size + ')';
      lista.innerHTML = '';
      snap.forEach(d => {
        const c = d.data();
        const fecha = c.fecha?.toDate ? c.fecha.toDate().toLocaleDateString('es-MX',{day:'numeric',month:'short',year:'numeric'}) : '';
        lista.innerHTML += `<div class="comentario-item">
          <div class="comentario-autor">${c.autor || 'An√≥nimo'}</div>
          <div class="comentario-texto">${c.texto}</div>
          <div class="comentario-fecha">${fecha}</div>
        </div>`;
      });
    } catch(e) {}
  }

  window.votar = async function(epId, tipo, btn) {
    const key = 'voto_' + epId;
    const prev = localStorage.getItem(key);
    if (prev === tipo) return;
    try {
      const ref = doc(db,'episodios',epId);
      if (!(await getDoc(ref)).exists()) await setDoc(ref,{likes:0,dislikes:0});
      const u = {};
      u[tipo==='like'?'likes':'dislikes'] = increment(1);
      if (prev) u[prev==='like'?'likes':'dislikes'] = increment(-1);
      await updateDoc(ref, u);
      localStorage.setItem(key, tipo);
      document.querySelectorAll('#ep-'+epId+' .btn-like, #ep-'+epId+' .btn-dislike').forEach(b=>b.classList.remove('activo'));
      btn.classList.add('activo');
      cargarLikes(epId);
    } catch(e){ console.error(e); }
  };

  window.toggleComentarios = function(epId) {
    const sec = document.getElementById('com-' + epId);
    sec.classList.toggle('abierto');
    if (sec.classList.contains('abierto')) cargarComentarios(epId);
  };

  window.enviarComentario = async function(epId) {
    const texto = document.getElementById('texto-'+epId).value.trim();
    const nombre = document.getElementById('nombre-'+epId).value.trim();
    if (!texto) return;
    try {
      await addDoc(collection(db,'episodios',epId,'comentarios'), {
        autor: nombre || 'An√≥nimo', texto, fecha: serverTimestamp()
      });
      document.getElementById('texto-'+epId).value = '';
      document.getElementById('nombre-'+epId).value = '';
      cargarComentarios(epId);
    } catch(e){ console.error(e); }
  };

  // Restaurar votos guardados
  ['cap1'].forEach(id => {
    cargarLikes(id);
    cargarComentarios(id);
    const v = localStorage.getItem('voto_' + id);
    if (v==='like') document.querySelector('#ep-'+id+' .btn-like')?.classList.add('activo');
    if (v==='dislike') document.querySelector('#ep-'+id+' .btn-dislike')?.classList.add('activo');
  });
</script>

</body>
</html>
